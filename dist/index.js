const AUTHOR_COLORS=[{bubble:"#fdf4f4",badge:"#fbd1d2"},{bubble:"#f3f4f6",badge:"#e5e7eb"}];class BBMsgHistory extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}parseMessages(){const n=this.textContent||"",t=[];for(const e of n.split("\n")){const n=e.trim();if(!n.startsWith("- "))continue;const s=n.slice(2).trim(),o=s.indexOf(":");if(o<=0)continue;const i=s.slice(0,o).trim(),r=s.slice(o+1).trim();i&&r&&t.push({author:i,text:r})}return t}escapeHtml(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}render(){const n=this.parseMessages(),t=[];for(const{author:e}of n)t.includes(e)||t.push(e);const e=n.map(({author:n,text:e})=>{const s=t.indexOf(n),o=AUTHOR_COLORS[s%AUTHOR_COLORS.length];return`<div class="msg msg--${s%2==0?"left":"right"}">\n          <span class="msg__author" style="background:${o.badge}">${this.escapeHtml(n)}</span>\n          <span class="msg__text" style="background:${o.bubble}">${this.escapeHtml(e)}</span>\n        </div>`}).join("");this.shadowRoot.innerHTML=`\n      <style>\n        :host {\n          display: block;\n          font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,\n            "Helvetica Neue", Arial, sans-serif;\n        }\n\n        .history {\n          max-width: 640px;\n          margin: 0 auto;\n          padding: 16px;\n          display: flex;\n          flex-direction: column;\n          gap: 12px;\n          max-height: 480px;\n          overflow-y: auto;\n          scroll-behavior: smooth;\n        }\n\n        .history::-webkit-scrollbar {\n          width: 4px;\n        }\n\n        .history::-webkit-scrollbar-track {\n          background: transparent;\n        }\n\n        .history::-webkit-scrollbar-thumb {\n          background: #e5e7eb;\n          border-radius: 2px;\n        }\n\n        .msg {\n          display: flex;\n          flex-direction: column;\n          max-width: 75%;\n          gap: 4px;\n        }\n\n        .msg--left {\n          align-self: flex-start;\n          align-items: flex-start;\n        }\n\n        .msg--right {\n          align-self: flex-end;\n          align-items: flex-end;\n        }\n\n        .msg__author {\n          font-size: 11px;\n          color: #6b7280;\n          padding: 2px 8px;\n          border-radius: 4px;\n          font-weight: 500;\n          letter-spacing: 0.02em;\n        }\n\n        .msg__text {\n          font-size: 14px;\n          color: #111827;\n          padding: 8px 12px;\n          border-radius: 8px;\n          line-height: 1.5;\n          word-break: break-word;\n        }\n\n        @media (max-width: 480px) {\n          .history {\n            padding: 12px;\n            gap: 10px;\n          }\n\n          .msg {\n            max-width: 85%;\n          }\n\n          .msg__text {\n            font-size: 13px;\n          }\n        }\n      </style>\n      <div class="history">${e}</div>\n    `;const s=this.shadowRoot.querySelector(".history");s&&(s.scrollTop=s.scrollHeight)}}customElements.define("bb-msg-history",BBMsgHistory);export{BBMsgHistory};