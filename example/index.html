<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>bb-msg-history</title>
  <script src="../dist/index.js" type="module"></script>
  <style>
    :root {
      --bg: #fff;
      --fg: #000;
      --muted: #666;
      --muted-gray: #b3b3b3;
      --muted-bg: #ededed;
      --light-bg: #fafafa;
      --border: #eaeaea;
      --accent: #0066cc;
      --radius: 8px;
      --sidebar-width: 240px;
      --transparent-dotted-border: #ccc;
      --scrollbar-thumb: #9ca3af;
      --scrollbar-thumb-hover: #6b7280;
    }



    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0a0a0a;
        --fg: #fff;
        --muted: #888;
        --muted-bg: #111;
        --border: #222;
        --accent: #60a5fa;
        --scrollbar-thumb: #4b5563;
        --scrollbar-thumb-hover: #6b7280;
      }
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
      /* Firefox scrollbar */
      scrollbar-width: thin;
      scrollbar-color: var(--scrollbar-thumb) transparent;
    }

    /* WebKit scrollbar for html */
    html::-webkit-scrollbar {
      width: 6px;
    }

    html::-webkit-scrollbar-track {
      background: transparent;
      border-radius: 3px;
    }

    html::-webkit-scrollbar-thumb {
      background: var(--scrollbar-thumb);
      border-radius: 3px;
    }

    html::-webkit-scrollbar-thumb:hover {
      background: var(--scrollbar-thumb-hover);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      color: var(--fg);
      background: var(--bg);
      line-height: 1.6;
      font-size: 15px;
    }

    /* Layout */
    .layout {
      display: flex;
      min-height: 100vh;
    }

    .dotted {
      background-image: linear-gradient(var(--transparent-dotted-border) 33%, hsla(0, 0%, 100%, 0) 0);
      background-size: 1px 4px;
    }

    .dotted-top {
      background-position: top;
    }

    .dotted-bottom, .dotted-top {
      background-image: repeating-linear-gradient(90deg, var(--transparent-dotted-border) 0, var(--transparent-dotted-border) 1px, transparent 1px, transparent 4px);
      background-size: 100% 1px;
      background-repeat: no-repeat;
    }

    .dotted-right {
      background-position: 100%;
      background-repeat: repeat-y;
    }

    /* Sidebar */
    .sidebar {
      width: var(--sidebar-width);
      flex-shrink: 0;
      /* border-right: 1px dashed var(--border); */
      position: fixed;
      height: 100vh;
      overflow-y: auto;
      padding: 40px 32px;
      background-color: #fafafa;
      /* Firefox scrollbar */
      scrollbar-width: thin;
      scrollbar-color: var(--scrollbar-thumb) transparent;
    }

    .sidebar::-webkit-scrollbar {
      width: 6px;
    }

    .sidebar::-webkit-scrollbar-track {
      background: transparent;
      border-radius: 3px;
    }

    .sidebar::-webkit-scrollbar-thumb {
      background: var(--scrollbar-thumb);
      border-radius: 3px;
    }

    .sidebar::-webkit-scrollbar-thumb:hover {
      background: var(--scrollbar-thumb-hover);
    }

    .logo {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 40px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-icon {
      width: 28px;
      height: 28px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 14px;
    }

    .nav-section {
      margin-bottom: 28px;
    }

    .nav-title {
      font-size: 0.6rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--muted-gray);
      margin-bottom: 12px;
      padding-left: 12px;
    }

    .nav-list {
      list-style: none;
    }

    .nav-list li {
      margin-bottom: 2px;
    }

    .nav-list a {
      display: block;
      color: var(--muted);
      text-decoration: none;
      font-size: 14px;
      padding: 8px 12px;
      border-radius: var(--radius);
      transition: all 0.15s;
    }

    .nav-list a:hover {
      color: var(--fg);
      /* background: var(--muted-bg); */
    }

    .nav-list a.active {
      color: var(--fg);
      background: var(--muted-bg);
      font-weight: 500;
    }

    /* Main content */
    .main {
      flex: 1;
      margin-left: var(--sidebar-width);
      padding: 90px;
      max-width: 800px;
      /* Firefox scrollbar */
      scrollbar-width: thin;
      scrollbar-color: var(--scrollbar-thumb) transparent;
    }

    .main::-webkit-scrollbar {
      width: 6px;
    }

    .main::-webkit-scrollbar-track {
      background: transparent;
      border-radius: 3px;
    }

    .main::-webkit-scrollbar-thumb {
      background: var(--scrollbar-thumb);
      border-radius: 3px;
    }

    .main::-webkit-scrollbar-thumb:hover {
      background: var(--scrollbar-thumb-hover);
    }

    /* Typography */
    h1 {
      font-size: 40px;
      font-weight: 700;
      letter-spacing: -0.03em;
      margin-bottom: 16px;
      line-height: 1.2;
    }

    .subtitle {
      color: var(--muted);
      font-size: 17px;
      line-height: 1.6;
      margin-bottom: 48px;
    }

    h2 {
      font-size: 24px;
      font-weight: 600;
      margin: 48px 0 20px;
      letter-spacing: -0.02em;
      scroll-margin-top: 32px;
    }

    h3 {
      font-size: 16px;
      font-weight: 600;
      margin: 32px 0 12px;
    }

    p {
      margin-bottom: 16px;
      color: var(--muted);
    }

    a {
      color: var(--accent);
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    /* Code */
    code {
      font-family: "SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, monospace;
      font-size: 13px;
      background: var(--light-bg);
      padding: 2px 6px;
      border-radius: 4px;
      color: var(--fg);
    }

    pre {
      background: var(--light-bg);
      padding: 20px;
      overflow-x: auto;
      border-radius: var(--radius);
      margin: 16px 0 24px;
      border: 1px solid var(--border);
      scrollbar-width: thin;
    }

    pre code {
      background: none;
      padding: 0;
      font-size: 13.5px;
      line-height: 1.6;
    }

    /* Preview card */
    .preview {
      /* border: 1px solid var(--border); */
      /* border-radius: var(--radius); */
      padding: 24px 8px;
      margin: 20px 0 24px;
      /* background: var(--light-bg); */
    }

    /* Buttons */
    .btn-group {
      display: flex;
      gap: 8px;
      margin: 16px 0 24px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 8px 16px;
      font-size: 14px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--light-bg);
      color: var(--fg);
      cursor: pointer;
      transition: all 0.15s;
      font-family: inherit;
    }

    .btn:hover {
      background: var(--muted-bg);
      border-color: var(--muted);
    }

    .btn:active {
      transform: scale(0.98);
    }

    /* Steps */
    .steps {
      counter-reset: step;
      list-style: none;
    }

    .steps > li {
      position: relative;
      padding-left: 40px;
      margin-bottom: 40px;
    }

    .steps > li::before {
      counter-increment: step;
      content: counter(step);
      position: absolute;
      left: 0;
      top: 0;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--muted-bg);
      color: var(--muted);
      font-size: 13px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .steps h3 {
      margin-top: 0;
      font-size: 18px;
    }

    /* Install box */
    .install-box {
      background: var(--light-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px 20px;
      margin: 16px 0;
    }

    .install-box code {
      background: transparent;
      font-size: 14px;
    }

    /* Divider */
    hr {
      border: none;
      border-top: 1px solid var(--border);
      margin: 48px 0;
    }

    /* Back to top */
    .back-to-top {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: transparent;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 12px rgba(0,0,0,0.15);
      opacity: 0;
      visibility: hidden;
      transform: translateY(10px) scale(0.9);
      transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s ease;
      text-decoration: none;
      color: var(--muted);
      z-index: 100;
    }

    .back-to-top.visible {
      opacity: 1;
      visibility: visible;
      transform: translateY(0) scale(1);
    }

    .back-to-top:hover {
      color: var(--fg);
      transform: translateY(-2px) scale(1);
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
    }

    .back-to-top:active {
      transform: translateY(0) scale(0.95);
    }

    .back-to-top svg {
      width: 20px;
      height: 20px;
    }

    /* Mobile */
    @media (max-width: 1024px) {
      .sidebar {
        display: none;
      }
      .main {
        margin-left: 0;
        padding: 32px 24px;
        max-width: none;
      }
      h1 {
        font-size: 32px;
      }
    }
  </style>
</head>
<body>
  <div class="layout">
    <!-- Sidebar -->
    <aside class="sidebar dotted dotted-right">
      <div class="logo">
        <span>&lt;bb-msg-history /&gt;</span>
      </div>
      
      <nav>
        <div class="nav-section">
          <div class="nav-title">Overview</div>
          <ul class="nav-list">
            <!-- <li><a href="#introduction">Introduction</a></li> -->
            <li><a href="#installation">Installation</a></li>
          </ul>
        </div>
        
        <div class="nav-section">
          <div class="nav-title">Examples</div>
          <ul class="nav-list">
            <li><a href="#basic">Basic Usage</a></li>
            <li><a href="#custom-avatar">Custom Avatars</a></li>
            <li><a href="#append">Append Messages</a></li>
            <li><a href="#grouping">Message Grouping</a></li>
            <li><a href="#fuzzy">Fuzzy Matching</a></li>
            <li><a href="#scrollable">Scrollable View</a></li>
            <li><a href="#multiparty">Multi-party</a></li>
            <li><a href="#dark-mode">Dark Mode</a></li>
          </ul>
        </div>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="main">
      <h1 id="introduction">Introduction</h1>
      <p class="subtitle">A chat-style message history web component. Render conversations from plain text, with avatars, bubbles, and smooth animations.</p>

      <h2 id="installation">Installation</h2>
      <p>Install the component from your command line.</p>
      <div class="install-box">
        <code>npm install @bbki.ng/bb-msg-history</code>
      </div>
      <!-- <p>Or use the CDN version:</p>
      <pre><code>&lt;script type="module" src="https://cdn.jsdelivr.net/npm/@bbki.ng/bb-msg-history@latest/dist/index.js"&gt;&lt;/script&gt;</code></pre> -->

      <h2 id="basic">Basic Usage</h2>
      <p>Use plain text with <code>author: message</code> format. Each author gets a letter avatar by default.</p>
      <div class="preview">
        <bb-msg-history>
          bbki.ng: Ë∞ÅÂëÄ
          xwy: Ë∞ÅË∞ÅË∞ÅÔºå‰Ω†Áå¥Áà∑Áà∑ÔºÅ
        </bb-msg-history>
      </div>
      <pre><code>&lt;bb-msg-history&gt;
  bbki.ng: Ë∞ÅÂëÄ
  xwy: Ë∞ÅË∞ÅË∞ÅÔºå‰Ω†Áå¥Áà∑Áà∑ÔºÅ
&lt;/bb-msg-history&gt;</code></pre>

      <h2 id="custom-avatar">Custom Avatars</h2>
      <p>Use <code>setAuthor()</code> to customize avatars (emoji, SVG, or image), side position, and bubble colors.</p>
      <div class="preview">
        <bb-msg-history id="custom-avatar-demo">
          me: Hey there!
          me: How's it going?
          friend: Pretty good, thanks!
          friend: What are you up to?
          me: Just trying out this component
          friend: Looks great!
        </bb-msg-history>
      </div>
      <script>
        customElements.whenDefined('bb-msg-history').then(() => {
          const el = document.getElementById('custom-avatar-demo');
          el.setAuthor('me', { avatar: 'üê±', side: 'right', bubbleColor: '#f3f4f6' });
          el.setAuthor('friend', { avatar: 'üê∂', side: 'left', bubbleColor: '#e0f2fe' });
        });
      </script>
      <pre><code>el.setAuthor('me', { avatar: 'üê±', side: 'right', bubbleColor: '#f3f4f6' });
el.setAuthor('friend', { avatar: 'üê∂', side: 'left', bubbleColor: '#e0f2fe' });</code></pre>

      <h2 id="append">Append Messages</h2>
      <p>Use <code>appendMessage()</code> to add messages programmatically with smooth scrolling.</p>
      <div class="preview">
        <bb-msg-history id="append-demo" style="--bb-max-height: 200px;">
          alice: Try the appendMessage() API!
          bob: Click the buttons below to add messages
        </bb-msg-history>
      </div>
      <div class="btn-group">
        <button class="btn" id="append-alice-btn">Add from alice</button>
        <button class="btn" id="append-bob-btn">Add from bob</button>
      </div>
      <script>
        (() => {
          const el = document.getElementById('append-demo');
          const aliceBtn = document.getElementById('append-alice-btn');
          const bobBtn = document.getElementById('append-bob-btn');
          
          const aliceMsgs = [
            'This uses the appendMessage() API',
            'It scrolls smoothly to new messages',
            'Much better UX for chat apps!',
            'Try clicking multiple times',
          ];
          const bobMsgs = [
            'Yeah, smooth scrolling is nice',
            'The API is simple too',
            'Just pass { author, text }',
            'And it handles the rest!',
          ];
          let aliceIdx = 0;
          let bobIdx = 0;
          
          customElements.whenDefined('bb-msg-history').then(() => {
            el.setAuthor('alice', { avatar: 'üë©', side: 'right', bubbleColor: '#e0f2fe' });
            el.setAuthor('bob', { avatar: 'üë®', side: 'left', bubbleColor: '#ecfdf5' });
          });
          
          aliceBtn.addEventListener('click', () => {
            el.appendMessage({
              author: 'alice',
              text: aliceMsgs[aliceIdx % aliceMsgs.length]
            });
            aliceIdx++;
          });
          
          bobBtn.addEventListener('click', () => {
            el.appendMessage({
              author: 'bob',
              text: bobMsgs[bobIdx % bobMsgs.length]
            });
            bobIdx++;
          });
        })();
      </script>
      <pre><code>el.appendMessage({ author: 'alice', text: 'Hello!' });
el.appendMessage({ author: 'bob', text: 'How are you?' });</code></pre>

      <h2 id="grouping">Message Grouping</h2>
      <p>Consecutive messages from the same author are grouped together. The avatar is only shown on the first message.</p>
      <div class="preview">
        <bb-msg-history id="grouping-demo">
          alice: First message
          alice: Second message, avatar hidden
          alice: Third, still hidden
          bob: Got it!
          bob: I'll send two as well
        </bb-msg-history>
      </div>
      <script>
        customElements.whenDefined('bb-msg-history').then(() => {
          const el = document.getElementById('grouping-demo');
          el.setAuthor('alice', { avatar: 'üë©', side: 'right', bubbleColor: '#f5f5f5' });
          el.setAuthor('bob', { avatar: 'üë®', side: 'left', bubbleColor: '#ecfdf5' });
        });
      </script>

      <h2 id="fuzzy">Fuzzy Matching</h2>
      <p>Author names containing a configured key will reuse that config. For example, <code>"alice(phone)"</code> matches <code>"alice"</code>.</p>
      <div class="preview">
        <bb-msg-history id="fuzzy-demo">
          alice: Normal message from alice
          alice(phone): This name contains "alice", reuses her config
          alice_work: This too!
          bob: Just bob
        </bb-msg-history>
      </div>
      <script>
        customElements.whenDefined('bb-msg-history').then(() => {
          const el = document.getElementById('fuzzy-demo');
          el.setAuthor('alice', { avatar: 'üë©', side: 'right', bubbleColor: '#e0f2fe' });
          el.setAuthor('bob', { avatar: 'üë®', side: 'left' });
        });
      </script>

      <h2 id="scrollable">Scrollable View</h2>
      <p>Long conversations automatically scroll. Use <code>--bb-max-height</code> CSS variable to customize the container height.</p>
      <div class="preview">
        <bb-msg-history style="--bb-max-height: 200px;">
          alice: Hey, are you free this weekend?
          bob: Yeah, what's up?
          alice: Want to grab coffee?
          bob: Sounds good! When?
          alice: Saturday morning, around 10?
          bob: Perfect. Which place?
          alice: The usual spot on Main St.
          bob: Great, see you then!
          alice: Can't wait!
          bob: Me neither. It's been a while.
          alice: Way too long!
          bob: Agreed. See you Saturday.
          alice: I'll bring that book you wanted.
          bob: Oh right! Thanks for remembering.
          alice: No problem. See you!
          bob: See ya!
        </bb-msg-history>
      </div>
      <pre><code>&lt;bb-msg-history style="--bb-max-height: 200px;"&gt;...&lt;/bb-msg-history&gt;</code></pre>

      <h2 id="multiparty">Multi-party Chat</h2>
      <p>Support for more than two participants in a conversation.</p>
      <div class="preview">
        <bb-msg-history id="multi-party-demo">
          me: Hey everyone, let's have a meeting
          alice: Sure thing
          bob: On my way
          dave: I'm here too
          me: Let's get started
          alice: OK
          bob: No problem
          dave: Got it
          me: That's all for today
        </bb-msg-history>
      </div>
      <script>
        customElements.whenDefined('bb-msg-history').then(() => {
          const el = document.getElementById('multi-party-demo');
          el.setAuthor('me', { avatar: 'üòé', side: 'right', bubbleColor: '#f5f5f5' });
          el.setAuthor('alice', { avatar: 'üë©', side: 'left', bubbleColor: '#e0f2fe' });
          el.setAuthor('bob', { avatar: 'üë®', side: 'left', bubbleColor: '#ecfdf5' });
        });
      </script>

      <h2 id="dark-mode">Dark Mode</h2>
      <p>Automatically adapts to system dark mode preference via <code>prefers-color-scheme</code>. Features cool blue-tinted slate colors for better visual hierarchy.</p>
      <div class="preview" style="background: #0f172a; border-radius: 8px;">
        <bb-msg-history theme="dark">
          alice: Dark mode conversation
          bob: Adapts automatically
          alice: Cool blue-tinted bubbles
          bob: Better visual hierarchy
          charlie: Letter avatars too!
        </bb-msg-history>
      </div>
      <p>Toggle your system dark mode to see it everywhere, or use <code>&lt;bb-msg-history theme="dark"&gt;</code> to force dark mode.</p>

      <footer style="margin-top: 90px; padding-top: 90px;" class="dotted dotted-top">
        <p style="font-size: 14px; color: var(--muted);">
          by <a href="https://bbki.ng" target="_blank" rel="noopener">bbki.ng</a>
        </p>
      </footer>
    </main>
  </div>

  <a href="#introduction" class="back-to-top" id="backToTop" title="Back to top" aria-label="Back to top">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="18 15 12 9 6 15"></polyline>
    </svg>
  </a>

  <script>
    // Back to top button
    const backToTop = document.getElementById('backToTop');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 300) {
        backToTop.classList.add('visible');
      } else {
        backToTop.classList.remove('visible');
      }
    });

    // Active nav highlighting
    const sections = document.querySelectorAll('h1[id], h2[id]');
    const navLinks = document.querySelectorAll('.nav-list a');
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === '#' + entry.target.id) {
              link.classList.add('active');
            }
          });
        }
      });
    }, { threshold: 0, rootMargin: '-8% 0px -85% 0px' });
    
    sections.forEach(section => observer.observe(section));
  </script>
</body>
</html>
