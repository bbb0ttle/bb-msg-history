<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>bb-msg-history</title>
  <script src="../dist/index.js" type="module"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      color: #222;
      background: #fff;
      line-height: 1.7;
      padding: 80px 20px;
    }

    .wrap {
      max-width: 680px;
      margin: 0 auto;
    }

    header {
      margin-bottom: 80px;
    }

    h1 {
      font-size: 24px;
      font-weight: 500;
      letter-spacing: -0.02em;
      margin-bottom: 12px;
    }

    .lead {
      color: #666;
      font-size: 16px;
    }

    section {
      margin-bottom: 60px;
    }

    h2 {
      font-size: 13px;
      font-weight: 400;
      color: #999;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 24px;
    }

    code {
      font-family: "SF Mono", Monaco, monospace;
      font-size: 13px;
      background: #f5f5f5;
      padding: 2px 6px;
      border-radius: 2px;
    }

    pre {
      background: #f5f5f5;
      padding: 20px;
      overflow-x: auto;
      border-radius: 2px;
    }

    pre code {
      background: none;
      padding: 0;
    }

    .card {
      border-radius: 8px;
      padding: 4px;
      margin-bottom: 16px;
    }

    .install {
      background: #fafafa;
      padding: 24px;
      border-radius: 2px;
    }

    .install p {
      margin-bottom: 12px;
      font-size: 14px;
      color: #666;
    }

    .install pre {
      background: #fff;
      border: 1px solid #eee;
    }

    @media (prefers-color-scheme: dark) {
      body { background: #111827; color: #e5e7eb; }
      .lead { color: #9ca3af; }
      h2 { color: #6b7280; }
      code { background: #1f2937; color: #e5e7eb; }
      pre { background: #1f2937; color: #e5e7eb; }
      .install { background: #1f2937; }
      .install p { color: #9ca3af; }
      .install pre { background: #111827; border-color: #374151; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>&lt;bb-msg-history /&gt;</h1>
      <p class="lead">A chat-style message history web component.</p>
    </header>

    <!-- 1. 基本用法：内置作者 bbki.ng(右侧) 和 xwy(左侧) -->
    <section>
      <h2>Basic — built-in authors</h2>
      <div class="card">
        <bb-msg-history>
          bbki.ng: 谁呀？
          xwy: 谁谁谁，你猴爷爷！
        </bb-msg-history>
      </div>

      <pre><code>&lt;bb-msg-history&gt;
  bbki.ng: 谁呀？
  xwy: 谁谁谁，你猴爷爷！
&lt;/bb-msg-history&gt;</code></pre>
    </section>

    <!-- 2. 连续消息分组：同一作者连续发送，后续消息头像隐藏 -->
    <section>
      <h2>Consecutive messages — avatar grouping</h2>
      <div class="card">
        <bb-msg-history>
          bbki.ng: 第一条
          bbki.ng: 第二条，头像隐藏了
          bbki.ng: 第三条，还是隐藏
          xwy: 收到！
          xwy: 我也连发两条
        </bb-msg-history>
      </div>
    </section>

    <!-- 3. 内置首字符头像作者：小乌鸦（使用首字符 + 自定义粉色气泡） -->
    <section>
      <h2>Built-in first-char avatar — 小乌鸦</h2>
      <div class="card">
        <bb-msg-history>
          bbki.ng: 小乌鸦你好呀
          小乌鸦: 你好！我用首字符当头像
          小乌鸦: 但气泡颜色是自定义的粉色
          bbki.ng: 好看！
        </bb-msg-history>
      </div>
    </section>

    <!-- 4. 未知作者：自动生成首字母头像，默认左侧显示 -->
    <section>
      <h2>Unknown authors — letter avatars</h2>
      <div class="card">
        <bb-msg-history>
          alice: Hello!
          bob: Hi there!
          charlie: Hey everyone!
          alice: Nice to meet you all
        </bb-msg-history>
      </div>
    </section>

    <!-- 5. 模糊匹配：作者名包含内置 key 时复用其配置 -->
    <section>
      <h2>Fuzzy matching — author name contains built-in key</h2>
      <div class="card">
        <bb-msg-history>
          bbki.ng(电话): 这个名字包含 bbki.ng，所以用相同的头像和右侧布局
          xwy_bot: 这个名字包含 xwy，所以用粉色气泡和左侧布局
          bbki.ng: 原版作者
        </bb-msg-history>
      </div>
    </section>

    <!-- 6. 单条消息 -->
    <section>
      <h2>Single message</h2>
      <div class="card">
        <bb-msg-history>
          bbki.ng: 就一条消息，也能正常渲染
        </bb-msg-history>
      </div>
    </section>

    <!-- 7. 长文本换行 -->
    <section>
      <h2>Long text — word wrap</h2>
      <div class="card">
        <bb-msg-history>
          alice: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
          bob: 这是一段很长的中文消息，用来测试中文环境下的自动换行效果。消息气泡应该能够正确地处理长文本，不会溢出容器边界，同时保持良好的可读性和视觉效果。
          alice: Superlongwordwithoutanyspacestotesttheoverflowwrapandwordbreakbehaviorofthemessagebubblecomponent
        </bb-msg-history>
      </div>
    </section>

    <!-- 8. 滚动长对话 -->
    <section>
      <h2>Scrollable long conversation</h2>
      <div class="card">
        <bb-msg-history>
          alice: Hey, are you free this weekend?
          bob: Yeah, what's up?
          alice: Want to grab coffee?
          bob: Sounds good! When?
          alice: Saturday morning, around 10?
          bob: Perfect. Which place?
          alice: The usual spot on Main St.
          bob: Great, see you then!
          alice: Can't wait!
          bob: Me neither. It's been a while.
          alice: Way too long!
          bob: Agreed. See you Saturday.
          alice: I'll bring that book you wanted.
          bob: Oh right! Thanks for remembering.
          alice: No problem. See you!
          bob: See ya!
        </bb-msg-history>
      </div>
    </section>

    <!-- 9. 空状态：无消息时显示 "No messages" -->
    <section>
      <h2>Empty state</h2>
      <div class="card">
        <bb-msg-history></bb-msg-history>
      </div>

      <pre><code>&lt;bb-msg-history&gt;&lt;/bb-msg-history&gt;</code></pre>
    </section>

    <!-- 10. 多人混合对话：内置作者 + 首字符作者 + 未知作者 -->
    <section>
      <h2>Multi-party mixed conversation</h2>
      <div class="card">
        <bb-msg-history>
          bbki.ng: 大家好，开个会
          xwy: 好的好的
          小乌鸦: 来了来了
          dave: 我也在
          bbki.ng: 那我们开始吧
          xwy: OK
          小乌鸦: 没问题
          dave: 收到
          bbki.ng: 今天就到这里
        </bb-msg-history>
      </div>
    </section>

    <!-- 11. 自定义最大高度：通过 CSS 变量 --bb-max-height 控制 -->
    <section>
      <h2>Custom max-height — CSS variable</h2>
      <div class="card">
        <bb-msg-history style="--bb-max-height: 200px;">
          alice: This container is only 200px tall
          bob: So it should scroll sooner
          alice: Let's add more messages
          bob: To demonstrate the effect
          alice: One more line
          bob: And another
          alice: Almost there
          bob: Yep, scrolling now!
          alice: Great, it works
          bob: Nice and compact
        </bb-msg-history>
      </div>

      <pre><code>&lt;bb-msg-history style="--bb-max-height: 200px;"&gt;
  ...
&lt;/bb-msg-history&gt;</code></pre>
    </section>

    <!-- 12. 动态更新：MutationObserver 自动重渲染 -->
    <section>
      <h2>Dynamic update — reactive content</h2>
      <div class="card">
        <bb-msg-history id="dynamic-demo" style="--bb-max-height: 200px;">
          alice: Click the button below to add a message
        </bb-msg-history>
      </div>
      <button id="add-msg-btn" style="
        margin-top: 8px;
        margin-bottom: 8px;
        padding: 8px 16px;
        font-size: 14px;
        border: 1px solid #ddd;
        border-radius: 4px;
        background: #fafafa;
        cursor: pointer;
      ">Add message</button>
      <script>
        (() => {
          const el = document.getElementById('dynamic-demo');
          const btn = document.getElementById('add-msg-btn');
          const authors = ['bob', 'charlie', 'alice'];
          const msgs = [
            'Hey, I was added dynamically!',
            'Me too, via MutationObserver!',
            'The component re-renders automatically',
            'No manual refresh needed',
            'Pretty cool, right?',
          ];
          let i = 0;
          btn.addEventListener('click', () => {
            const author = authors[i % authors.length];
            const text = msgs[i % msgs.length];
            el.textContent += `\n${author}: ${text}`;
            i++;
          });
        })();
      </script>

      <pre><code>// Component auto re-renders when textContent changes
const el = document.querySelector('bb-msg-history');
el.textContent += '\nbob: Added dynamically!';</code></pre>
    </section>

    <!-- 13. Dark mode 预览 -->
    <section>
      <h2>Dark mode — prefers-color-scheme</h2>
      <div class="card" style="background: #111827; padding: 16px; border-radius: 8px;">
        <bb-msg-history style="color-scheme: dark;">
          bbki.ng: Dark mode 下的对话
          xwy: 会自动适配深色主题
          bbki.ng: 气泡和背景都会变色
          xwy: 好看！
        </bb-msg-history>
      </div>
      <p style="margin-top: 12px; font-size: 13px; color: #999;">
        ↑ Toggle your system to dark mode to see it in action across the whole page, or inspect this card which forces a dark background.
      </p>
    </section>

    <section>
      <h2>Installation</h2>
      <div class="install">
        <p>npm</p>
        <pre><code>npm install @bbki.ng/bb-msg-history</code></pre>

        <p style="margin-top: 20px;">CDN</p>
        <pre><code>&lt;script type="module" src="https://cdn.jsdelivr.net/npm/@bbki.ng/bb-msg-history@latest/dist/index.js"&gt;&lt;/script&gt;</code></pre>
      </div>
    </section>
  </div>
</body>
</html>
